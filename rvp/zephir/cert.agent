# -*- coding: UTF-8 -*-
"""
agent de surveillance des certificats ipsec (validité)
"""

from os import system
from zephir.monitor.agents.cert import Cert

# on vérifie si le service rvp est configuré pour fonctionner
res = system('/usr/sbin/ipsec listcerts | grep -q subject')
if res == 0:
    certs = Cert('cert', period=3600, description='Validité des certificats ipsec', section="""Services""")
    AGENTS = [certs]
else:
    # on supprime le répertoire des stats rvp si il existe (pour ne pas avoir d'erreur sur zephir)
    AGENTS = []
