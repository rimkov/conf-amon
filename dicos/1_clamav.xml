<?xml version="1.0" encoding="utf-8"?>

<creole>

    <files>
	<package>antivirus-pkg</package>
	<service servicelist='enable_clamd'>clamav-freshclam</service>
	<service servicelist='enable_clamd'>clamav-daemon</service>
        <file filelist='enable_clamd' name='/etc/clamav/clamd.conf'/>
        <file filelist='enable_clamd' name='/etc/clamav/freshclam.conf'/>
    </files>

    <variables>
	<family name='services'>
		<variable name='enable_clamd' type='string' description="Activation de l'anti-virus sur le proxy" >
			<value>non</value>
		</variable>
	</family>
        <family name='clamav' mode='expert'>
            <variable name='clam_max_file_size' type='number' description='Taille maximum pour un fichier à scanner (en Mo)'>
                <value>5</value>
            </variable>
            <variable name='clam_max_scan_size' type='number' description='Quantité de données maximum à scanner pour une archive (en Mo)'>
                <value>20</value>
            </variable>
            <variable name='clam_max_recursion' type='number' description='Profondeur maximale pour le scan des archives'>
                <value>12</value>
            </variable>
            <variable name='clam_max_files' type='number' description='Nombre maximum de fichiers à scanner dans une archive'>
                <value>5000</value>
            </variable>
            <variable name='clam_detect_pua' type='string' description='Détection des applications indésirables'>
                <value>no</value>
            </variable>
            <variable name='clam_scan_pdf' type='string' description='Scan du contenu des fichiers PDF'>
                <value>no</value>
            </variable>
            <variable name='clam_broken_exe' type='string' description='Détection des fichiers exécutables corrompus'>
                <value>no</value>
            </variable>
        </family>
	<separators>
	</separators>
    </variables>

    <constraints>
        <check name='valid_enum' target='enable_clamd'>
            <param>['oui','non']</param>
        </check>
        <check name='obligatoire' target='clam_max_file_size'/>
        <check name='obligatoire' target='clam_max_scan_size'/>
        <check name='obligatoire' target='clam_max_recursion'/>
        <check name='obligatoire' target='clam_max_files'/>
        <check name='valid_enum' target='clam_detect_pua'>
            <param>['yes','no']</param>
        </check>
        <check name='valid_enum' target='clam_scan_pdf'>
            <param>['yes','no']</param>
        </check>
        <check name='valid_enum' target='clam_broken_exe'>
            <param>['yes','no']</param>
        </check>
        <condition name='hidden_if_in' source='enable_clamd'>
            <param>non</param>
            <target type='filelist'>enable_clamd</target>
            <target type='servicelist'>enable_clamd</target>
            <target type='family'>clamav</target>
        </condition>
    </constraints>

    <help>
    </help>

</creole>
