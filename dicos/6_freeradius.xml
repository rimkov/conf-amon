<?xml version='1.0' encoding='utf-8'?>

<creole>
        <files>
		<file filelist='freeradius' name='/etc/freeradius/clients.conf' source='freerad-clients.conf'/>
		<file filelist='freeradius' name='/etc/freeradius/eap.conf' source='freerad-eap.conf'/>
		<file filelist='freeradius' name='/etc/freeradius/huntgroups' source='freerad-huntgroups'/>
		<file filelist='freeradius' name='/etc/freeradius/radiusd.conf'/>
		<file filelist='freeradius' name='/etc/freeradius/users' source='freerad-users'/>
		<file filelist='freeradius' name='/etc/freeradius/modules/ldap' source='freerad-ldap'/>
		<file filelist='freeradius' name='/etc/freeradius/sites-enabled/default' source='freerad-default'/>
		<file filelist='freeradius' name='/etc/freeradius/sites-enabled/inner-tunnel' source='freerad-inner-tunnel'/>
        </files>
		<!-- **** Dictionnaire optionnel pour freeradius **** -->
        <variables>
		<family name='services'>
			<variable name='freeradius' type='string' description='Activation du service Freeradius'>
				<value>non</value>
			</variable>
		</family>
		<family name='freeradius' hidden='True'>
			<variable name='freerad_listen_int' type='string' description='Interface sur laquelle freeradius écoutera'>
				<value>eth1</value>
			</variable>
			<variable name='freerad_nas_ip' type='ip' description="Adresse IP du serveur d'accès (NAS)" multi='True'/>
			<variable name='freerad_nas_name' type='string' description="Nom court du serveur d'accès (NAS)"/>
			<variable name='freerad_nas_passwd' type='string' description="Secret partagé avec le serveur d'accès (NAS)"/>
			<variable name='freerad_nas_type' type='string' description="Type du serveur d'accès (NAS)">
				<value>other</value>
			</variable>
			<variable name='freerad_ldap_ip' type='ip' description='Adresse IP du serveur LDAP permettant de récupérer les comptes utilisateurs'/>
			<variable name='freerad_ldap_base_dn' type='string' description="Suffixe racine de l'annuaire LDAP (base DN)">
				<value>o=gouv,c=fr</value>
			</variable>
			<variable name='freerad_ldap_group' type='string' description="Groupes d'utilisateurs à récupérer dans l'annuaire LDAP" multi='True'/>
			<variable name='freerad_group_vlan' type='number' description="Numéro de VLAN à attribuer à ce groupe"/>
		</family>
			<separators>
				<separator name='freeradius'>Mise en place de Freeradius</separator>
				<separator name='freerad_nas_ip'>Configuration des NAS</separator>
				<separator name='freerad_ldap_ip'>Configuration LDAP</separator>
				<separator name='freerad_ldap_group'>Configuration des groupes et des vlans</separator>
			</separators> 
        </variables>
        <constraints>
		<condition name='hidden_if_in' source='freeradius'>
			<param>non</param> 
			<target type='variable'>freerad_listen_int</target>
			<target type='variable'>freerad_nas_ip</target>
			<target type='variable'>freerad_nas_name</target>
			<target type='variable'>freerad_nas_passwd</target>
			<target type='variable'>freerad_nas_type</target>
			<target type='variable'>freerad_ldap_ip</target>
			<target type='variable'>freerad_ldap_base_dn</target>
			<target type='variable'>freerad_ldap_group</target>
			<target type='variable'>freerad_group_vlan</target>
			<target type='filelist'>freeradius</target>
		</condition>
		<check name="valid_enum" target='freeradius'>
			<param>['non','oui']</param>
		</check>
		<check name="valid_enum" target='freerad_nas_type'>
			<param>['cisco','computone','livingston','max40xx','multitech','netserver','pathras','patton','portslave','tc','usrhiper','other']</param>
		</check>
		<check name="valid_enum" target='freerad_ldap_group'>
			<param>['Eleves','professeurs']</param>
			<param name="checkval">False</param> 
		</check>
	<!-- **** Groupes **** -->
		 <group master='freerad_nas_ip'>
                        <slave>freerad_nas_passwd</slave>
                        <slave>freerad_nas_name</slave>
                        <slave>freerad_nas_type</slave>
		</group>
		 <group master='freerad_ldap_group'>
                        <slave>freerad_group_vlan</slave>
		</group>
	</constraints>
	<help>
        </help>
</creole>
