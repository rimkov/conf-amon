<?xml version="1.0" encoding="utf-8"?>

<creole>
	<files>
		  <service servicelist='snort'>snort</service>
		  <service servicelist='samhain'>samhain</service>
		  <file filelist='sondes' name='/etc/prelude/default/client.conf' source='prelude-client.conf'/>
		  <file filelist='sondes' name='/etc/prelude/default/global.conf' source='prelude-global.conf'/>
		  <file filelist='samhain' name='/etc/init.d/samhain' source='samhain_init'/>
		  <file filelist='samhain' name='/etc/samhain/samhainrc' />
		  <file filelist='snort' name='/etc/snort/snort.conf' />
		  <file filelist='snort' name='/etc/snort/snort.debian.conf' />
		  <file filelist='snort' name='/etc/oinkmaster.conf' />
		  <file filelist='snort' rm='True' name='/etc/cron.daily/snort' source='cron-snort' />
	</files>
<!--************************************************************************************************* -->
	<variables>
		<family name='services'>
 			<variable name='activer_sonde_prelude' type='string' description="Gestion des sondes Prelude" >
                                <value>non</value>
                        </variable>
		</family>
		<family name='sondes'>
			<variable name='administrateur_email' type='string' description="Adresse courriel de contact"/>
			<variable name='adresse_ip_prelude_manager' type='ip' description="Adresse IP du serveur Prelude Manager "/>
			<variable name='sonde_snort' type='string' description="Activation de la sonde SNORT" >
				<value>non</value>
			</variable>
			<variable name='smtp_snort' type='string' description="Liste des serveurs SMTP sur le réseau" multi="True"/>
			<variable name='http_snort' type='string' description="Liste des serveurs HTTP sur le réseau" multi="True"/>
			<variable name='dns_snort' type='string' description="Liste des serveurs DNS sur le réseau" multi="True"/>
			<variable name='sonde_samhain' type='string' description="Activation de la sonde SAMHAIN" >
				<value>non</value>
			</variable>
			<variable name='sonde_nufw' type='string' description="Activation de la sonde NuFW" >
				<value>non</value>
			</variable>
		</family>
		<family name='snort' mode='expert'>
			<variable name='snort_rules_liste' type='string' description="Activation de la sonde NuFW" multi='True'>
				<value>attack-responses</value>
				<value>bad-traffic</value>
				<value>ddos</value>
				<value>dos</value>
				<value>experimental</value>
				<value>exploit</value>
				<value>finger</value>
				<value>ftp</value>
				<value>icmp</value>
				<value>imap</value>
				<value>local</value>
				<value>misc</value>
				<value>mysql</value>
				<value>netbios</value>
				<value>nntp</value>
				<value>oracle</value>
				<value>other-ids</value>
				<value>pop2</value>
				<value>pop3</value>
				<value>rpc</value>
				<value>rservices</value>
				<value>scan</value>
				<value>smtp</value>
				<value>snmp</value>
				<value>sql</value>
				<value>telnet</value>
				<value>tftp</value>
				<value>web-cgi</value>
				<value>web-coldfusion</value>
				<value>web-iis</value>
				<value>web-frontpage</value>
				<value>web-misc</value>
				<value>web-client</value>
				<value>web-php</value>
				<value>x11</value>
			</variable>
		</family>
	</variables>
	<separators>
		<separator name='sonde_snort'>Configuration de la sonde SNORT</separator>
		<separator name='sonde_samhain'>Configuration de la sonde Samhain</separator>
		<separator name='sonde_nufw'>Configuration de la sonde NuFW</separator>
		<separator name='activer_sonde_prelude'>Activation des sondes Prelude</separator>
	</separators>
<!--************************************************************************************************* -->
	<constraints>
		<check name="valid_enum" target="activer_sonde_prelude">
                  <param>['oui','non']</param>
                </check>
		<check name="valid_enum" target="sonde_snort" >
			    <param>['oui','non']</param>
		</check>
		<check name="valid_enum" target="sonde_samhain" >
			    <param>['oui','non']</param>
		</check>
		<check name="valid_enum" target="sonde_nufw" >
			    <param>['oui','non']</param>
		</check>
		<check name="valid_enum" target="snort_rules_liste">
			<param type="python">eosfunc.list_files('/etc/snort/rules','*.rules',True)</param>
			<param name="checkval">False</param>
		</check>
		<check name='obligatoire' target='administrateur_email'/>
		<check name='obligatoire' target='adresse_ip_prelude_manager'/>
		<condition name='hidden_if_in' source='sonde_snort'>
			<param>non</param>
			<target type='family'>snort</target>
			<target type='servicelist'>snort</target>
			<target type='filelist'>snort</target>
		</condition>
		<condition name='hidden_if_in' source='sonde_samhain'>
			<param>non</param>
			<target type='servicelist'>samhain</target>
			<target type='filelist'>samhain</target>
		</condition>
                 <condition name='hidden_if_in' source='activer_sonde_prelude'>
                	<param>non</param>
			<target type='family'>sondes</target>
			<target type='filelist'>sondes</target>
			<target type='servicelist'>sondes</target>
		</condition>
	</constraints>
<!--************************************************************************************************* -->
	<help>
	</help>
</creole>
