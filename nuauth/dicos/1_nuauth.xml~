<?xml version="1.0" encoding="utf-8"?>

<creole>
	<files>
		<service>nuauth></service>
		<file name='/etc/default/nuauth'/>
		<file name='/etc/default/nufw'/>
		<file name='/etc/ldap.conf'/>
		<file name='/etc/nsswitch.conf'/>
		<file filelist='nufw' name='/etc/nufw/nuauth.conf'/>
		<file filelist='nufw' name='/etc/pam.d/nuauth' source='nuauth.pamd'/>
		<file filelist='nufw' name='/etc/init.d/nufw' source='nufw.init'/>
	</files>
	<!--************************************************************************************************* -->
	<variables>
		<family name='general'>
			<variable name='nuauth_tls_key' type='string' description="Clef privée pour Nuauth" hidden='True'/>
			<variable name='nuauth_tls_cert' type='string' description="Certificat pour Nuauth" hidden='True'/>
			<variable name='nuauth_tls_cacert' type='string' description="Certification pour Nuauth" hidden='True'/>
		</family>
		<family name='general'>
			<variable name='active_nufw' type='string' description="Activation de l'authentification réseau (NuFW)" >
				<value>non</value>
			</variable>
		</family>
		<family name='Interface-1'>
			<variable name='nuauth_eth1' type='string' description="Activer l'authentification NuAuth sur cette interface" >
				<value>non</value>
			</variable>
		</family>
		<family name='Interface-2'>
			<variable name='nuauth_eth2' type='string' description="Activer l'authentification NuAuth sur cette interface" >
				<value>non</value>
			</variable>
		</family>
		<family name='Interface-3'>
			<variable name='nuauth_eth3' type='string' description="Activer l'authentification NuAuth sur cette interface" >
				<value>non</value>
			</variable>
		</family>
		<family name='Interface-4'>
			<variable name='nuauth_eth4' type='string' description="Activer l'authentification NuAuth sur cette interface" >
				<value>non</value>
			</variable>
		</family>
		<family name='Nufw' hidden='True'>
			<variable name='nuauth_nss_ldap_host' type='ip' description="Adresse du serveur LDAP pour l'authentification NuFW" />
			<variable name='nuauth_nss_ldap_dn' type='string' description="Suffixe racine de l'annuaire LDAP (base DN)">
              			<value>o=gouv,c=fr</value>
			</variable>
			<variable name='nuauth_nss_ldap_tls' type='string' description="Activation du chiffrement de l'authentification (TLS)">
				<value>oui</value>
			</variable>
			<variable name='nuauth_verbosity' type='Number' description='Niveau de verbosité du démon Nuauth' expert='True'>
				<value>3</value>
			</variable>
		</family>
		<separator>
			<separator name='active_nufw'>NuFW (Now User Filtering Works)</separator>
		</separator>
	</variables>
	<constraints>
		<auto name='key_nuauth' target='nuauth_tls_key'/>
		<auto name='cert_nuauth' target='nuauth_tls_cert'/>
		<auto name='cacert_nuauth' target='nuauth_tls_cacert'/>
		<check name='obligatoire' target='nuauth_nss_ldap_host'/>
		<check name='obligatoire' target='nuauth_nss_ldap_dn'/>
		<check name="valid_enum" target='active_nufw'>
			<param>['oui','non']</param>
		</check>
		<check name="valid_enum" target='nuauth_nss_ldap_tls'>
			<param>['oui','non']</param>
		</check>
		<check name="valid_enum" target='nuauth_eth1'>
			<param>['oui','non']</param>
		</check>
		<check name="valid_enum" target='nuauth_eth2'>
			<param>['oui','non']</param>
		</check>
		<check name="valid_enum" target='nuauth_eth3'>
			<param>['oui','non']</param>
		</check>
		<check name="valid_enum" target='nuauth_eth4'>
			<param>['oui','non']</param>
		</check>
                <check name="valid_enum" target="nuauth_verbosity">
                  <param>['1','2','3','4','5','6','7','8','9']</param>
                </check>
		<condition name='hidden_if_in' source='active_nufw'>
			<param>non</param>
			<target type='family'>Nufw</target>
			<target type='family'>nufw-options</target>
			<target type='variable'>nuauth_eth1</target>
			<target type='variable'>nuauth_eth2</target>
			<target type='variable'>nuauth_eth3</target>
			<target type='variable'>nuauth_eth4</target>
			<target type='variable'>nuauth_verbosity</target>
			<target type='filelist'>nufw</target>
			<target type='servicelist'>nufw</target>
		</condition>
	</constraints>
